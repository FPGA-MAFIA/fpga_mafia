//------------------------------------------------------------
// Title : draw tree
// Project : big_core
//------------------------------------------------------------
// File : draw_tree.c
// Author : Amichai Ben-David
// Adviser : Amichai Ben-David
// Created : 06/2023
//------------------------------------------------------------
// Description :
// POC of using the graphic library to draw lines and circles
//------------------------------------------------------------
#include "big_core_defines.h"
#include "graphic_vga.h"
unsigned int sin_table[360]  = {0,17,35,52,70,87,105,122,139,156,174,191,208,225,
                                242,259,276,292,309,326,342,358,375,391,407,423,438,
                                454,469,485,500,515,530,545,559,574,588,602,616,629,
                                643,656,669,682,695,707,719,731,743,755,766,777,788,
                                799,809,819,829,839,848,857,866,875,883,891,899,906,
                                914,921,927,934,940,946,951,956,961,966,970,974,978,
                                982,985,988,990,993,995,996,998,999,999,1000,1000,1000,
                                999,999,998,996,995,993,990,988,985,982,978,974,970,966,
                                961,956,951,946,940,934,927,921,914,906,899,891,883,875,
                                866,857,848,839,829,819,809,799,788,777,766,755,743,731,
                                719,707,695,682,669,656,643,629,616,602,588,574,559,545,
                                530,515,500,485,469,454,438,423,407,391,375,358,342,326,
                                309,292,276,259,242,225,208,191,174,156,139,122,105,87,70,
                                52,35,17,0,-17,-35,-52,-70,-87,-105,-122,-139,-156,-174,-191,
                                -208,-225,-242,-259,-276,-292,-309,-326,-342,-358,-375,-391,-407,
                                -423,-438,-454,-469,-485,-500,-515,-530,-545,-559,-574,-588,-602,
                                -616,-629,-643,-656,-669,-682,-695,-707,-719,-731,-743,-755,-766,
                                -777,-788,-799,-809,-819,-829,-839,-848,-857,-866,-875,-883,-891,
                                -899,-906,-914,-921,-927,-934,-940,-946,-951,-956,-961,-966,-970,
                                -974,-978,-982,-985,-988,-990,-993,-995,-996,-998,-999,-999,-1000,
                                -1000,-1000,-999,-999,-998,-996,-995,-993,-990,-988,-985,-982,-978,
                                -974,-970,-966,-961,-956,-951,-946,-940,-934,-927,-921,-914,-906,-899,
                                -891,-883,-875,-866,-857,-848,-839,-829,-819,-809,-799,-788,-777,-766,
                                -755,-743,-731,-719,-707,-695,-682,-669,-656,-643,-629,-616,-602,-588,
                                -574,-559,-545,-530,-515,-500,-485,-469,-454,-438,-423,-407,-391,-375,
                                -358,-342,-326,-309,-292,-276,-259,-242,-225,-208,-191,-174,-156,-139,-122,-105,-87,-70,-52,-35,-17};
unsigned int cos_table[360]  =  {1000,1000,999,999,998,996,995,993,990,988,985,982,978,974,970,966,961,956,951,946,940,
                                934,927,921,914,906,899,891,883,875,866,857,848,839,829,819,809,799,788,777,766,755,743,
                                731,719,707,695,682,669,656,643,629,616,602,588,574,559,545,530,515,500,485,469,454,438,
                                423,407,391,375,358,342,326,309,292,276,259,242,225,208,191,174,156,139,122,105,87,70,52,
                                35,17,0,-17,-35,-52,-70,-87,-105,-122,-139,-156,-174,-191,-208,-225,-242,-259,-276,-292,-309,
                                -326,-342,-358,-375,-391,-407,-423,-438,-454,-469,-485,-500,-515,-530,-545,-559,-574,-588,-602,
                                -616,-629,-643,-656,-669,-682,-695,-707,-719,-731,-743,-755,-766,-777,-788,-799,-809,-819,-829,
                                -839,-848,-857,-866,-875,-883,-891,-899,-906,-914,-921,-927,-934,-940,-946,-951,-956,-961,-966,
                                -970,-974,-978,-982,-985,-988,-990,-993,-995,-996,-998,-999,-999,-1000,-1000,-1000,-999,-999,-998,
                                -996,-995,-993,-990,-988,-985,-982,-978,-974,-970,-966,-961,-956,-951,-946,-940,-934,-927,-921,-914,
                                -906,-899,-891,-883,-875,-866,-857,-848,-839,-829,-819,-809,-799,-788,-777,-766,-755,-743,-731,-719,
                                -707,-695,-682,-669,-656,-643,-629,-616,-602,-588,-574,-559,-545,-530,-515,-500,-485,-469,-454,-438,
                                -423,-407,-391,-375,-358,-342,-326,-309,-292,-276,-259,-242,-225,-208,-191,-174,-156,-139,-122,-105,
                                -87,-70,-52,-35,-17,0,17,35,52,70,87,105,122,139,156,174,191,208,225,242,259,276,292,309,326,342,358,
                                375,391,407,423,438,454,469,485,500,515,530,545,559,574,588,602,616,629,643,656,669,682,695,707,719,731,
                                743,755,766,777,788,799,809,819,829,839,848,857,866,875,883,891,899,906,914,921,927,934,940,946,951,956,
                                961,966,970,974,978,982,985,988,990,993,995,996,998,999,999,1000};



#define MAX_ANGLE 360

void draw_fractal_tree(int x1, int y1, int angle, int length, int depth) {
    if (length < 2) {
        return;
    }

    int x2 = x1 + (length * cos_table[angle]) / 1024;
    int y2 = y1 + (length * sin_table[angle]) / 1024;

    draw_line(x1, y1, x2, y2, 1);

    draw_fractal_tree(x2, y2, (angle + 30) % MAX_ANGLE, length >> 1, depth + 1);
    draw_fractal_tree(x2, y2, (angle - 30 + MAX_ANGLE) % MAX_ANGLE, length >> 1, depth + 1);
}

int main()  {  
    int x1 = 20;  // Starting x-coordinate
    int y1 = 20;  // Starting y-coordinate
    int angle = 0;  // Starting angle (facing upwards)
    int length = 8;  // Starting length
    int depth = 0;  // Starting depth

    draw_fractal_tree(x1, y1, angle, length, depth);
    return 0;
}
